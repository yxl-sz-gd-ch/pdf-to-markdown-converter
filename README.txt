==================================================================
  PDF to Markdown 批量转换器 (PdftoMd) - 使用说明
==================================================================

欢迎使用 PdftoMd，一个基于强大的 `marker-pdf` 库的图形化批量转换工具。
本工具旨在帮助您轻松地将 PDF 文件高质量地转换为干净、结构化的 Markdown 格式，
包括文本、表格和图片。

------------------
  快速开始
------------------

1. **解压文件**:
   将下载的压缩包解压到您希望存放本程序的任意位置（例如 D:\Tools\PdftoMd）。

2. **保持目录结构**:
   **非常重要！** 请确保 `markermodels` 文件夹与主程序 `PdftoMd.exe` 始终位于同一个目录下。程序依赖此文件夹中的模型文件来工作。
   
   正确的目录结构应如下所示：
   /PdftoMd/
   ├── PdftoMd.exe
   ├── (其他程序依赖文件...)
   └── /markermodels/
       └── (内含多个模型子文件夹...)

3. **运行程序**:
   直接双击 `PdftoMd.exe` 启动程序。

   **注意**: 首次启动时，程序需要加载所有模型，可能需要一到两分钟时间，界面可能会短暂无响应，这是正常现象。后续启动会快很多。

------------------
  基本使用步骤
------------------

1. **选择文件**:
   - 点击 "选择 PDF 文件" 或 "选择包含 PDF 的文件夹" 按钮，将您需要转换的 PDF 添加到列表中。

2. **设置输出目录**:
   - 在 "基础设置" 选项卡中，点击 "浏览..." 选择一个用于存放转换结果的文件夹。

3. **配置选项 (可选)**:
   - 根据您的需求，在 "基础设置"、"LLM 设置" 和 "高级设置" 中调整参数。将鼠标悬停在某些选项上可能会显示更多提示信息。

4. **开始转换**:
   - 点击右侧的 "🚀 开始转换" 按钮。
   - 您可以在下方的日志窗口中看到详细的转换进度和信息。

------------------
  高级功能：连接本地大语言模型 (LLM)
------------------

为了获得最高的转换精度（例如，更准确的标题识别、代码块格式化等），本工具可以连接您在本地运行的大语言模型。

**前提**: 您需要已安装并运行了像 **LM Studio**, **Ollama** 或其他兼容 OpenAI API 的本地模型服务。

**如何配置**:
1. 在 "LLM 设置" 选项卡中，勾选 "使用 LLM 提高准确性"。
2. **LLM 服务**: 选择 "OpenAI" (此选项兼容大多数本地服务)。
3. **API 密钥**: 通常留空即可。
4. **Base URL**: 填入您的本地服务地址。
   - 对于 LM Studio: `http://localhost:1234/v1`
   - 对于 Ollama: `http://localhost:11434/v1`
5. **模型名称**: 填入您在本地服务中加载并希望使用的模型ID（例如 `deepseek-r1-0528-qwen3-8b`）。
   - **提示**: 建议使用 70亿/80亿 (7B/8B) 参数的通用指令模型，以平衡速度和精度。

------------------
  常见问题 (FAQ)
------------------

**Q: 程序启动很慢或没有反应？**
A: 首次启动需要加载大量模型，请耐心等待。如果长时间无响应，请检查您的电脑内存是否充足（建议至少有 8GB RAM）。

**Q: 转换后的 Markdown 文件在哪里？**
A: 在您指定的 "输出目录" 中。如果 PDF 中包含图片，还会有一个同名的 `_images` 文件夹存放提取出的图片。

**Q: 我可以移动 `markermodels` 文件夹吗？**
A: 不可以。它必须和 `PdftoMd.exe` 在同一级目录。如果移动，程序将找不到模型而无法工作。

**Q: 打包后的程序为什么这么大？**
A: `markermodels` 文件夹包含了 `marker` 运行所需的核心深度学习模型（用于版面分析、OCR等），这些模型本身就很大。本程序已经采用了模型与程序分离的设计，以方便更新。

**Q: 我可以更新 `markermodels` 文件夹吗？**
A: 可以。如果 `marker` 库发布了新的模型，您可以下载新的模型文件夹来替换旧的，而无需重新下载整个程序。

------------------
  技术支持与反馈
------------------

本程序由 AI根据用户需求生成。`marker` 库是其核心技术，项目地址：
https://github.com/VikParuchuri/marker

祝您使用愉快！
